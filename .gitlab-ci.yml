image: node:alpine

services:
  - mongo

variables:
  NODE_ENV: 'test'
  MONGO_URI: 'mongodb://mongo/ci_db'

stages:
  - test

server_test:
  stage: test
  before_script:
    - cd server
    - npm install
  script:
    - npm test